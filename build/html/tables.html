<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Constructing a table &mdash; ATpy v0.9.4 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.4',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ATpy v0.9.4 documentation" href="index.html" />
    <link rel="next" title="Accessing Table Data" href="data.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="data.html" title="Accessing Table Data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ATpy v0.9.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/atpy_logo.png" alt="Logo"/>
            </a></p>
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Constructing a table</a><ul>
<li><a class="reference external" href="#creating-a-table">Creating a table</a></li>
<li><a class="reference external" href="#populating-the-table">Populating the table</a><ul>
<li><a class="reference external" href="#reading-data-from-a-file">Reading data from a file</a></li>
<li><a class="reference external" href="#reading-data-from-a-database">Reading data from a database</a></li>
<li><a class="reference external" href="#adding-columns-to-a-table">Adding columns to a table</a></li>
<li><a class="reference external" href="#vector-columns">Vector Columns</a></li>
<li><a class="reference external" href="#writing-the-data-to-a-file">Writing the data to a file</a></li>
</ul>
</li>
<li><a class="reference external" href="#adding-meta-data">Adding meta-data</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="installation.html"
                                  title="previous chapter">Installation</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="data.html"
                                  title="next chapter">Accessing Table Data</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/tables.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="constructing-a-table">
<span id="tables"></span><h1>Constructing a table<a class="headerlink" href="#constructing-a-table" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="docutils literal"><span class="pre">Table</span></tt> class is the basic entity in ATpy. It consists of table data
and metadata. The data is stored using a <a class="reference external" href="http://numpy.scipy.org/">NumPy</a>
structured array. The metadata includes units, null values, and column
descriptions, as well as comments and keywords.</p>
<p>Data can be stored in the table using many of the <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/arrays.scalars.html#built-in-scalar-types">NumPy types</a>,
including booleans, 8, 16, 32, and 64-bit signed and unsigned integers, 32
and 64-bit floats, and strings. Not all file formats and databases support
reading and writing all of these types &#8211; for more information, see
<a class="reference external" href="formats.html#formats"><em>Supported Formats</em></a>.</p>
<div class="section" id="creating-a-table">
<h2>Creating a table<a class="headerlink" href="#creating-a-table" title="Permalink to this headline">¶</a></h2>
<p>The simplest way to create an instance of the <tt class="docutils literal"><span class="pre">Table</span></tt> is to call the
class with no arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">atpy</span><span class="o">.</span><span class="n">Table</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="populating-the-table">
<h2>Populating the table<a class="headerlink" href="#populating-the-table" title="Permalink to this headline">¶</a></h2>
<p>A table can be populated either manually or by reading data from a file or database. Reading data into a table erases previous content. Data can be manually added once a table has been read in from a file.</p>
<div class="section" id="reading-data-from-a-file">
<h3>Reading data from a file<a class="headerlink" href="#reading-data-from-a-file" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">read(...)</span></tt> method can be used to read in a table from a file. To date, ATpy supports the following file formats:</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://archive.stsci.edu/fits/fits_standard/">FITS</a> tables (<tt class="docutils literal"><span class="pre">type=fits</span></tt>)</li>
<li><a class="reference external" href="http://www.ivoa.net/Documents/VOTable/">VO</a> tables (<tt class="docutils literal"><span class="pre">type=vo</span></tt>)</li>
<li><a class="reference external" href="http://irsa.ipac.caltech.edu/applications/DDGEN/Doc/ipac_tbl.html">IPAC</a> tables (<tt class="docutils literal"><span class="pre">type=ipac</span></tt>)</li>
<li><a class="reference external" href="http://www.hdfgroup.org/HDF5/">HDF5</a> (<tt class="docutils literal"><span class="pre">type=hdf5</span></tt>)</li>
</ul>
</blockquote>
<p>Now that ATpy has integrates with <a class="reference external" href="http://cxc.harvard.edu/contrib/asciitable/">asciitable</a>, the following formats are also supported:</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="http://vizier.u-strasbg.fr/doc/catstd.htx">CDS</a> (<tt class="docutils literal"><span class="pre">type=cds</span></tt> or <tt class="docutils literal"><span class="pre">type=mrt</span></tt>)</li>
<li>DAOPhot (<tt class="docutils literal"><span class="pre">type=daophot</span></tt>)</li>
<li>RDB (<tt class="docutils literal"><span class="pre">type=rdb</span></tt>)</li>
<li>Arbitrary ASCII tables (<tt class="docutils literal"><span class="pre">type=ascii</span></tt>)</li>
</ul>
</blockquote>
<p>When reading a table from a file, the only required argument is the filename. For example, to read a VO table called <tt class="docutils literal"><span class="pre">example.xml</span></tt>, the following should be used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;example.xml&#39;</span><span class="p">)</span>
<span class="go">Auto-detected input type: VO table</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">read()</span></tt> method will in most cases correctly identify the format of the file from the extension. As seen above, the default behavior is to specifically tell the user what format is being assumed, but this can be controlled via the <tt class="docutils literal"><span class="pre">verbose</span></tt> argument.</p>
<p>In some cases, <tt class="docutils literal"><span class="pre">read()</span></tt> will fail to determine the input type. In this case, or to override the automatically selected type, the input type can be specified using the <tt class="docutils literal"><span class="pre">type</span></tt> argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;example.xml&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;vo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">read</span></tt> method supports additional file-format-dependent options. These are described in more detail in <a class="reference external" href="formats.html#formats"><em>Supported Formats</em></a>.</p>
<p>In cases where multiple tables are available in a table file, ATpy will display a message to the screen with instructions of how to specify which table to read in. Alternatively, see <a class="reference external" href="table_sets.html#tablesets"><em>Table Sets</em></a> for information on how to read all tables into a single <tt class="docutils literal"><span class="pre">TableSet</span></tt> instance.</p>
<p>As a convenience, it is possible to create a <tt class="docutils literal"><span class="pre">Table</span></tt> instance and read in data in a single command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s">&#39;example.xml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any arguments given to <tt class="docutils literal"><span class="pre">Table</span></tt> are passed on to the <tt class="docutils literal"><span class="pre">read</span></tt> method, so the above is equivalent to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;example.xml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-data-from-a-database">
<h3>Reading data from a database<a class="headerlink" href="#reading-data-from-a-database" title="Permalink to this headline">¶</a></h3>
<p>Reading a table from a database is very similar to reading a table from a file. The main difference is that for databases, the first argument should be the database type, To date, ATpy supports the following database types:</p>
<blockquote>
<ul class="simple">
<li>SQLite (<tt class="docutils literal"><span class="pre">sqlite</span></tt>)</li>
<li>MySQL (<tt class="docutils literal"><span class="pre">mysql</span></tt>)</li>
<li>PostGreSQL (<tt class="docutils literal"><span class="pre">postgres</span></tt>)</li>
</ul>
</blockquote>
<p>The remaining arguments depend on the database type. For example, an SQLite database can be read by specifying the database filename:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;sqlite&#39;</span><span class="p">,</span><span class="s">&#39;example.db&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For MySQL and PostGreSQL databases, it is possible to specify the database, table, authentication, and host parameters. The various options are descried in more detail in <a class="reference external" href="formats.html#formats"><em>Supported Formats</em></a>. As for files, the <tt class="docutils literal"><span class="pre">verbose</span></tt> and <tt class="docutils literal"><span class="pre">type</span></tt> arguments can be used.</p>
<p>As for reading in from files, one can read in data from a database while initializing the <tt class="docutils literal"><span class="pre">Table</span></tt> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s">&#39;sqlite&#39;</span><span class="p">,</span><span class="s">&#39;example.db&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is possible to specify a full SQL query using the <tt class="docutils literal"><span class="pre">query</span></tt> argument.
Any valid SQL is allowed. If this is used, the table name should
nevertheless be specified using the <tt class="docutils literal"><span class="pre">table</span></tt> argument.</p>
</div>
</div>
<div class="section" id="adding-columns-to-a-table">
<h3>Adding columns to a table<a class="headerlink" href="#adding-columns-to-a-table" title="Permalink to this headline">¶</a></h3>
<p>It is possible to add columns to an empty or an existing table. Two methods exist for this. The first, <tt class="docutils literal"><span class="pre">add_column</span></tt>, allows users to add an existing array to a column. For example, the following can be used to add a column named <tt class="docutils literal"><span class="pre">time</span></tt> where the variable <tt class="docutils literal"><span class="pre">time_array</span></tt> is a NumPy array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="n">time_array</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">add_column</span></tt> method also optionally takes metadata about the column, such as units, or a description. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="n">time_array</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s">&#39;seconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>indicates that the units of the column are seconds. It is also possible to convert the datatype of an array while adding it to a table by using the <tt class="docutils literal"><span class="pre">dtype</span></tt> argument. For example, the following stores the column from the above examples as 32-bit floating point values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="n">time_array</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s">&#39;seconds&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
<p>In some cases, it is desirable to add an empty column to a table, and populate it element by element. This can be done using the <tt class="docutils literal"><span class="pre">add_empty_column</span></tt> method. The only required arguments for this method are the name and the data type of the column:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">add_empty_column</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
</pre></div>
</div>
<p>If the column is the first one being added to an empty table, the <tt class="docutils literal"><span class="pre">shape</span></tt> argument should be used to specify the number of rows. This should either be an integer giving the number of rows, or a tuple in the case of vector columns (see <a class="reference internal" href="#vectorcolumns"><em>Vector Columns</em></a> for more details)</p>
</div>
<div class="section" id="vector-columns">
<span id="vectorcolumns"></span><h3>Vector Columns<a class="headerlink" href="#vector-columns" title="Permalink to this headline">¶</a></h3>
<p>As well as using one-dimensional columns is also possible to specify so-called vector columns, which are essentially two-dimensional arrays. Only FITS and VO tables support reading and writing these. The <tt class="docutils literal"><span class="pre">add_column</span></tt> method accepts two-dimensional arrays as input, and uses these to define vector columns. Empty vector columns can be created by using the <tt class="docutils literal"><span class="pre">add_empty_column</span></tt> method along with the <tt class="docutils literal"><span class="pre">shape</span></tt> argument to specify the full shape of the column. This should be a tuple of the form <tt class="docutils literal"><span class="pre">(n_rows,</span> <span class="pre">n_elements)</span></tt>.</p>
</div>
<div class="section" id="writing-the-data-to-a-file">
<h3>Writing the data to a file<a class="headerlink" href="#writing-the-data-to-a-file" title="Permalink to this headline">¶</a></h3>
<p>Writing data to files or databases is done through the <tt class="docutils literal"><span class="pre">write</span></tt> method. The arguments to this method are very similar to that of the <tt class="docutils literal"><span class="pre">read</span></tt> data. The only main difference is that the <tt class="docutils literal"><span class="pre">write</span></tt> method can take an <tt class="docutils literal"><span class="pre">overwrite</span></tt> argument that specifies whether or not to overwrite existing files.</p>
</div>
</div>
<div class="section" id="adding-meta-data">
<h2>Adding meta-data<a class="headerlink" href="#adding-meta-data" title="Permalink to this headline">¶</a></h2>
<p>Comments and keywords can be added to a table using the <tt class="docutils literal"><span class="pre">add_comment()</span></tt> and <tt class="docutils literal"><span class="pre">add_keyword()</span></tt> methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">add_comment</span><span class="p">(</span><span class="s">&quot;This is a great table&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">add_keyword</span><span class="p">(</span><span class="s">&quot;meaning&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="data.html" title="Accessing Table Data"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">ATpy v0.9.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, Eli Bressert and Thomas Robitaille.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.3.
    </div>
  </body>
</html>